<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="shimejiBrowserExtensionId" content="gohjpllcolmccldfdggmamodembldgpc" data-version="1.6.5">
    <title>Sign Up</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
    <link rel="stylesheet" href="./asset/base.css">
    <link rel="stylesheet" href="./asset/signup.css">
    <link rel="stylesheet" href="./asset/font/fontawesome-free-5.15.4-web/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="icon" href="./asset/img/logo web.png">

</head>
<body>
    <div class="grid">
        <div class="grid__row">
            <div action method="POST" class="sign-in" id="form-1">
                <a href="index.html">
                    <img class="sign-in__logo" src="./asset/img/logo web 2.png" alt="">
                </a>
                <h1 class="sign-in__h1" >CREATE ACCOUNT</h1>
                <div class="sign-in__icon">
                    <a href="gmail.com" class="sign-in__google">
                      <img src="./asset/img_singup/GG icon.png" alt="" style="width: 100%;">
                    </a>
                    <a href="facebook.com" class="sign-in__facebook">
                      <img src="./asset/img_singup/FB icon.png" alt="" style="width: 100%;">
                    </a>
                    <a href="twitter.com" class="sign-in__twitter">
                      <img src="./asset/img_singup/twitter icon.png" alt="" style="width: 100%;">
                    </a>
                </div>
                <p class="sign-in__or">OR</p>
              <form id = "reg-form">
                <div class="form-group">
                    <i class="form-group__icon fas fa-user"></i>
                    <input id="user" name="user" type="text" placeholder="user name" class="form-control">
                    <span class="form-message"></span>
                </div>
                <div class="form-group">
                    <i class="form-group__icon fas fa-lock"></i>
                    <input id="password" name="password" type="password" placeholder="Password" class="form-control">
                    <span class="form-message"></span>
                </div>
                <div class="form-group">
                    <i class="form-group__icon fas fa-lock"></i>
                    <input id="password_confirmation" name="password_confirmation" type="password" placeholder="Re-enter password" class="form-control">
                    <span class="form-message"></span>
                </div>
                <div class="form-group">
                    <i class="form-group__icon fas fa-phone-alt"></i>
                    <input id="tel" name="tel" type="tel" placeholder="Phone Number" class="form-control">
                    <span class="form-message"></span>
                </div>
                <button class="form-submit">Sign Up</button>
              </form>
                <div class="form-register">
                    <p class="form-register__infor">Already have an account.</p>
                    <a href="signin.html" class ="form-register__link">Sign In</a>
                </div>
                <!-- <a href="#" class="forgot-password">Forgot your password ?</a> -->
            </div>
            <div class="img-signin">
                <img src="./asset/img_singup/sign_in_banner.png" alt="" style="width: 95%;">
            </div>
        </div>
    </div>
    <div class="modal">
        <div class="notification">
            <div class="notification-error">
              <p class="notification-error__text" style="font-weight: bold; font-size: 5rem;">Congrats !!!</p>
              <p class="notification-error__text">Your account succesfully created</p>
              <button class="notification-cancel">OK</button>
            </div>
        </div>
    </div>
</body>
<script>

    document.addEventListener('DOMContentLoaded', function () {
      // Mong muốn của chúng ta
      Validator({
        form: '#form-1',
        formGroupSelector: '.form-group',
        errorSelector: '.form-message',
        rules: [
          Validator.isEmail('#user'),
          Validator.minLength('#password', 6),
          Validator.isRequired('#tel', 'Please enter the phone number'),
          Validator.isRequired('#password_confirmation'),
          Validator.isConfirmed('#password_confirmation', function () {
          return document.querySelector('#form-1 #password').value;
          }, 'Re-entered password is incorrect')
        ],
        onSubmit: function (data) {
          // Call API
          console.log(data);
        }
      });


      Validator({
        form: '#form-2',
        formGroupSelector: '.form-group',
        errorSelector: '.form-message',
        rules: [
          Validator.isEmail('#user'),
          Validator.minLength('#password', 6),
        ],
        onSubmit: function (data) {
          // Call API
          console.log(data);
        }
      });
    });
    const form = document.getElementById('reg-form')
    form.addEventListener('submit', registerUser)

    async function registerUser(event){
      event.preventDefault()
      const username = document.getElementById('user').value
      const password = document.getElementById('password').value
      const password_confirmation = document.getElementById('password_confirmation').value
      const phone = document.getElementById('tel').value

      const result = await fetch('/register',{
         method: 'POST',
         headers: {
           'Content-Type': 'application/json'
         },
         body: JSON.stringify({
           username,
           password,
           password_confirmation,
           phone
         })
      }).then((res) => res.json())

      if (result.status === 'ok') {
         alert('success')
         window.location.href = '/signin.html'
      }else {
        alert (result.error)
      }
    }

  </script>
<script src = "./asset/signin.js"></script>
</html>